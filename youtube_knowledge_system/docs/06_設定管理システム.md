# ç¬¬6ç« : è¨­å®šç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

## **ç« ã®æ¦‚è¦**

ã“ã®ç« ã§ã¯ã€ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¨­å®šã‚’çµ±ä¸€çš„ã«ç®¡ç†ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã«ã¤ã„ã¦è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚Enumã«ã‚ˆã‚‹å‹å®‰å…¨ãªè¨­å®šç®¡ç†ã€ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã«ã‚ˆã‚‹æ§‹é€ åŒ–ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚·ã‚¹ãƒ†ãƒ ã€è¨­å®šæ¤œè¨¼ã¾ã§ã€å®Ÿè·µçš„ãªè¨­å®šç®¡ç†æŠ€è¡“ã‚’ä½“ç³»çš„ã«å­¦ã³ã¾ã™ã€‚

**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: `managers/playlist_config_manager.py` (ç´„337è¡Œ)  
**ä¸»è¦æŠ€è¡“**: Enum, ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹, å‹ãƒ’ãƒ³ãƒˆ, ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³, è¨­å®šç®¡ç†

---

## **ğŸ“‹ playlist_config_manager.pyãƒ•ã‚¡ã‚¤ãƒ«ã®å…¨ä½“åƒ**

### **ãƒ•ã‚¡ã‚¤ãƒ«ã®ç›®çš„ã¨å½¹å‰²**

`managers/playlist_config_manager.py`ã¯ã€YouTubeãƒŠãƒ¬ãƒƒã‚¸ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹**è¨­å®šç®¡ç†ã®ä¸­æ ¸**ã‚’æ‹…ã†ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒæœãŸã™å½¹å‰²ã¯ï¼š

1. **ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¨­å®šã®ä¸€å…ƒç®¡ç†**: è¤‡æ•°ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®è¨­å®šã‚’çµ±åˆçš„ã«ç®¡ç†
2. **å‹å®‰å…¨ãªè¨­å®šå€¤ç®¡ç†**: Enumã«ã‚ˆã‚‹è¨­å®šå€¤ã®å³å¯†ãªåˆ¶å¾¡
3. **CRUDæ“ä½œã®æä¾›**: è¨­å®šã®ä½œæˆãƒ»èª­ã¿å–ã‚Šãƒ»æ›´æ–°ãƒ»å‰Šé™¤æ©Ÿèƒ½
4. **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»å¾©æ—§**: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨å¾©æ—§
5. **è¨­å®šæ¤œè¨¼**: è¨­å®šå†…å®¹ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½

### **ã‚·ã‚¹ãƒ†ãƒ å†…ã§ã®ä½ç½®ã¥ã‘**

```
YouTube Knowledge System è¨­å®šç®¡ç†ãƒ•ãƒ­ãƒ¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GUI/video_main_window.py           â”‚
â”‚  (ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šæ“ä½œ)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼ è¨­å®šå¤‰æ›´ãƒ»å–å¾—
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  managers/playlist_config_manager.py â”‚ â† ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â”‚  ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¨­å®šç®¡ç†                â”‚
â”‚  ãƒ»å‹å®‰å…¨æ€§ä¿è¨¼                       â”‚
â”‚  ãƒ»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç®¡ç†                    â”‚
â”‚  ãƒ»è¨­å®šæ¤œè¨¼                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼ è¨­å®šå–å¾—ãƒ»åé›†åˆ¶å¾¡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  collectors/multi_playlist_collector â”‚
â”‚  (è¨­å®šã«åŸºã¥ããƒ‡ãƒ¼ã‚¿åé›†)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **ä»–ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã®é–¢é€£æ€§**

- **`core/data_models.py`**: `PlaylistConfig`ãƒ»`UpdateFrequency`ãƒ»`PlaylistCategory`ã®å®šç¾©
- **`collectors/multi_playlist_collector.py`**: è¨­å®šæƒ…å ±ã«åŸºã¥ã„ãŸãƒ‡ãƒ¼ã‚¿åé›†
- **`config/settings.py`**: ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè¨­å®šã®å–å¾—
- **`gui/video_main_window.py`**: GUIæ“ä½œã«ã‚ˆã‚‹è¨­å®šå¤‰æ›´ãƒ»è¡¨ç¤º
- **`storage/unified_storage.py`**: è¨­å®šã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®é€£æº

### **ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆï¼ˆ337è¡Œã®å†…è¨³ï¼‰**

1. **åˆæœŸåŒ–ãƒ»è¨­å®š** (1-32è¡Œ): ã‚¯ãƒ©ã‚¹å®šç¾©ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè¨­å®šã€åŸºæœ¬æ§‹é€ 
2. **åŸºæœ¬CRUDæ“ä½œ** (33-143è¡Œ): è¨­å®šã®èª­ã¿è¾¼ã¿ãƒ»ä¿å­˜ãƒ»è¿½åŠ ãƒ»å‰Šé™¤
3. **é«˜åº¦ãªæ“ä½œ** (144-241è¡Œ): è¨­å®šæ›´æ–°ã€æœ‰åŠ¹åŒ–ãƒ»ç„¡åŠ¹åŒ–åˆ¶å¾¡
4. **ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»æ¤œç´¢** (242-291è¡Œ): è¨­å®šä¸€è¦§å–å¾—ã€æ¡ä»¶åˆ¥æ¤œç´¢
5. **çµ±è¨ˆãƒ»æ¤œè¨¼** (292-337è¡Œ): çµ±è¨ˆæƒ…å ±å–å¾—ã€è¨­å®šå¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯

---

## **ğŸ¯ Enumã«ã‚ˆã‚‹å‹å®‰å…¨ãªè¨­å®šç®¡ç†**

### **Enumã¨ã¯ï¼ˆåˆå¿ƒè€…å‘ã‘è§£èª¬ï¼‰**

#### **ğŸ”¢ åˆ—æŒ™å‹ã®åŸºæœ¬æ¦‚å¿µ**

**Enumã®ä»•çµ„ã¿**

Enumï¼ˆåˆ—æŒ™å‹ï¼‰ã¯ã€**é™å®šã•ã‚ŒãŸå€¤ã®é›†åˆã‚’å®šç¾©ã™ã‚‹ä»•çµ„ã¿**ã§ã™ã€‚ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ä¾‹ãˆã‚‹ã¨ï¼š

```python
# æ–‡å­—åˆ—ã§ã®è¨­å®šï¼ˆå±é™ºï¼‰
update_frequency = "daily"   # "dailly"ã¨ã„ã†ã‚¿ã‚¤ãƒãŒç™ºç”Ÿã—ã‚„ã™ã„
update_frequency = "weekly"  # å€¤ã®çµ±ä¸€æ€§ãŒä¿è¨¼ã•ã‚Œãªã„

# Enumã§ã®è¨­å®šï¼ˆå®‰å…¨ï¼‰
class UpdateFrequency(Enum):
    DAILY = "daily"
    WEEKLY = "weekly"
    MONTHLY = "monthly"

update_frequency = UpdateFrequency.DAILY  # ã‚¿ã‚¤ãƒä¸å¯ãƒ»å€¤ãŒçµ±ä¸€
```

**ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ã®ä¾‹**

```python
# æ–‡å­—åˆ—ãƒ™ãƒ¼ã‚¹ï¼ˆå•é¡Œã‚ã‚Šï¼‰
order = "spageti"  # ã‚¹ãƒšãƒ«ãƒŸã‚¹
order = "pasta"    # åŒã˜æ„å‘³ã ãŒè¡¨è¨˜ãŒé•ã†

# Enumãƒ™ãƒ¼ã‚¹ï¼ˆå‹å®‰å…¨ï¼‰
class MenuItem(Enum):
    SPAGHETTI = "spaghetti"
    PIZZA = "pizza"
    SALAD = "salad"

order = MenuItem.SPAGHETTI  # ã‚¹ãƒšãƒ«ãƒŸã‚¹ä¸å¯ãƒ»çµ±ä¸€è¡¨è¨˜
```

#### **ğŸ›¡ï¸ å‹å®‰å…¨æ€§ã®ãƒ¡ãƒªãƒƒãƒˆ**

**å‹å®‰å…¨æ€§ã¨ã¯**

å‹å®‰å…¨æ€§ã¯ã€**ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå®Ÿè¡Œæ™‚ã«å‹ã«é–¢ã™ã‚‹ã‚¨ãƒ©ãƒ¼ã‚’èµ·ã“ã•ãªã„ã“ã¨ã‚’ä¿è¨¼ã™ã‚‹ä»•çµ„ã¿**ã§ã™ï¼š

1. **ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã‚¨ãƒ©ãƒ¼æ¤œå‡º**: å®Ÿè¡Œå‰ã«å•é¡Œã‚’ç™ºè¦‹
2. **è‡ªå‹•è£œå®Œæ”¯æ´**: IDEã«ã‚ˆã‚‹æ­£ç¢ºãªå€™è£œè¡¨ç¤º
3. **æ„å›³ã—ãªã„å€¤ã®é˜²æ­¢**: ç„¡åŠ¹ãªå€¤ã®ä½¿ç”¨ã‚’é˜»æ­¢
4. **ãƒã‚°ã®æ—©æœŸç™ºè¦‹**: é–‹ç™ºæ®µéšã§ã®å•é¡Œç‰¹å®š

### **è¨­å®šç®¡ç†ã§ã®Enumæ´»ç”¨å®Ÿä¾‹**

#### **ğŸ”§ ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆæ›´æ–°é »åº¦ã®ç®¡ç†**

```python
from enum import Enum

class UpdateFrequency(Enum):
    """æ›´æ–°é »åº¦ã®åˆ—æŒ™å‹"""
    MANUAL = "manual"          # æ‰‹å‹•æ›´æ–°
    DAILY = "daily"            # æ¯æ—¥
    WEEKLY = "weekly"          # æ¯é€±
    MONTHLY = "monthly"        # æ¯æœˆ
    REAL_TIME = "real_time"    # ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ 
```

**åˆå¿ƒè€…å‘ã‘: Enumä½¿ç”¨ã®ãƒ¡ãƒªãƒƒãƒˆ**

```python
# å¾“æ¥ã®æ–‡å­—åˆ—ãƒ™ãƒ¼ã‚¹ï¼ˆå•é¡ŒãŒå¤šã„ï¼‰
def update_playlist(frequency: str):
    if frequency == "daily":      # âœ… æ­£ã—ã„
        # æ¯æ—¥æ›´æ–°
    elif frequency == "dailly":   # âŒ ã‚¿ã‚¤ãƒã‚¨ãƒ©ãƒ¼ï¼ˆå®Ÿè¡Œæ™‚ã¾ã§æ°—ã¥ã‹ãªã„ï¼‰
        # å®Ÿè¡Œã•ã‚Œãªã„
    elif frequency == "DAILY":    # âŒ å¤§æ–‡å­—å°æ–‡å­—ã®ä¸ä¸€è‡´
        # å®Ÿè¡Œã•ã‚Œãªã„

# Enumãƒ™ãƒ¼ã‚¹ï¼ˆå‹å®‰å…¨ï¼‰
def update_playlist(frequency: UpdateFrequency):
    if frequency == UpdateFrequency.DAILY:    # âœ… å‹å®‰å…¨
        # æ¯æ—¥æ›´æ–°
    elif frequency == UpdateFrequency.WEEKLY: # âœ… è‡ªå‹•è£œå®Œã§æ­£ç¢º
        # æ¯é€±æ›´æ–°
```

#### **ğŸ“‚ ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚«ãƒ†ã‚´ãƒªã®ç®¡ç†**

```python
class PlaylistCategory(Enum):
    """ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚«ãƒ†ã‚´ãƒªã®åˆ—æŒ™å‹"""
    MUSIC = "music"              # éŸ³æ¥½ç³»
    TUTORIAL = "tutorial"        # ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«
    ENTERTAINMENT = "entertainment"  # ã‚¨ãƒ³ã‚¿ãƒ¡
    NEWS = "news"                # ãƒ‹ãƒ¥ãƒ¼ã‚¹
    EDUCATION = "education"      # æ•™è‚²
    OTHER = "other"              # ãã®ä»–
```

**ã‚«ãƒ†ã‚´ãƒªç®¡ç†ã®å®Ÿè£…ä¾‹**

```python
def add_playlist(
    self, 
    url_or_id: str,
    display_name: str = "",
    category: PlaylistCategory = PlaylistCategory.OTHER,  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
    update_frequency: UpdateFrequency = UpdateFrequency.MANUAL,
    **kwargs
) -> Tuple[bool, str]:
    """ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’è¿½åŠ """
    
    # Enumã®å€¤æ¤œè¨¼ã¯è‡ªå‹•çš„ã«è¡Œã‚ã‚Œã‚‹
    # ç„¡åŠ¹ãªå€¤ãŒæ¸¡ã•ã‚ŒãŸå ´åˆã€ValueError ãŒç™ºç”Ÿ
    
    config = PlaylistConfig(
        playlist_id=playlist_id,
        category=category,           # å‹å®‰å…¨æ€§ãŒä¿è¨¼ã•ã‚Œã‚‹
        update_frequency=update_frequency,
        # ...ãã®ä»–ã®è¨­å®š
    )
```

### **Enumå¤‰æ›ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**

#### **ğŸ”„ æ–‡å­—åˆ—ã‹ã‚‰Enumã¸ã®å¤‰æ›**

```python
def update_config(self, playlist_id: str, **updates) -> Tuple[bool, str]:
    """ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¨­å®šã‚’æ›´æ–°"""
    
    for field, value in updates.items():
        # æ–‡å­—åˆ—ã‚’é©åˆ‡ãªEnumå‹ã«å¤‰æ›
        if field == 'update_frequency' and isinstance(value, str):
            try:
                value = UpdateFrequency(value)  # æ–‡å­—åˆ—â†’Enumå¤‰æ›
            except ValueError:
                return False, f"ç„¡åŠ¹ãªæ›´æ–°é »åº¦: {value}"
                
        elif field == 'category' and isinstance(value, str):
            try:
                value = PlaylistCategory(value)  # æ–‡å­—åˆ—â†’Enumå¤‰æ›
            except ValueError:
                return False, f"ç„¡åŠ¹ãªã‚«ãƒ†ã‚´ãƒª: {value}"
        
        setattr(config, field, value)
```

**åˆå¿ƒè€…å‘ã‘: Enumå¤‰æ›ã®ä»•çµ„ã¿**

```python
# Enumå¤‰æ›ã®å‹•ä½œä¾‹
try:
    freq = UpdateFrequency("daily")      # âœ… æˆåŠŸ
    print(freq)  # UpdateFrequency.DAILY
    
    freq = UpdateFrequency("invalid")    # âŒ ValueErrorç™ºç”Ÿ
except ValueError as e:
    print(f"ã‚¨ãƒ©ãƒ¼: {e}")  # "invalid is not a valid UpdateFrequency"
```

---

## **ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã«ã‚ˆã‚‹æ§‹é€ åŒ–è¨­å®š**

### **ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã¨ã¯ï¼ˆåˆå¿ƒè€…å‘ã‘è§£èª¬ï¼‰**

#### **ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã®åŸºæœ¬æ¦‚å¿µ**

**å¾“æ¥ã®ã‚¯ãƒ©ã‚¹ vs ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹**

```python
# å¾“æ¥ã®ã‚¯ãƒ©ã‚¹ï¼ˆè¨˜è¿°ãŒå†—é•·ï¼‰
class PlaylistConfigOld:
    def __init__(self, playlist_id: str, display_name: str, enabled: bool):
        self.playlist_id = playlist_id
        self.display_name = display_name
        self.enabled = enabled
    
    def __repr__(self):
        return f"PlaylistConfig(id={self.playlist_id}, name={self.display_name})"
    
    def __eq__(self, other):
        if not isinstance(other, PlaylistConfig):
            return False
        return (self.playlist_id == other.playlist_id and 
                self.display_name == other.display_name and
                self.enabled == other.enabled)

# ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ï¼ˆç°¡æ½”ãƒ»è‡ªå‹•ç”Ÿæˆï¼‰
@dataclass
class PlaylistConfigNew:
    playlist_id: str
    display_name: str
    enabled: bool = True  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
    
    # __init__, __repr__, __eq__ ãªã©ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹
```

#### **ğŸ¯ ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã®ä¸»è¦æ©Ÿèƒ½**

**è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰**

```python
@dataclass
class PlaylistConfig:
    playlist_id: str
    display_name: str
    priority: int = 3
    enabled: bool = True

# ä»¥ä¸‹ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹
config = PlaylistConfig("PLxxx", "ãƒ†ã‚¹ãƒˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ")

print(config)  # __repr__: PlaylistConfig(playlist_id='PLxxx', ...)
config1 == config2  # __eq__: ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å€¤ã«ã‚ˆã‚‹æ¯”è¼ƒ
```

### **è¨­å®šãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã®å®Ÿè£…è©³ç´°**

#### **ğŸ“ PlaylistConfigã‚¯ãƒ©ã‚¹ã®æ§‹é€ **

```python
@dataclass
class PlaylistConfig:
    """ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¨­å®šãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹"""
    
    # å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
    playlist_id: str
    display_name: str
    url: str
    
    # ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®šï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ä»˜ãï¼‰
    update_frequency: UpdateFrequency = UpdateFrequency.MANUAL
    priority: int = 3  # 1(é«˜) - 5(ä½)
    enabled: bool = True
    category: PlaylistCategory = PlaylistCategory.OTHER
    auto_analyze: bool = True
    
    # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
    description: str = ""
    tags: List[str] = field(default_factory=list)
    max_videos: Optional[int] = None
    
    # ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
    created_at: datetime = field(default_factory=datetime.now)
    last_updated: datetime = field(default_factory=datetime.now)
    last_sync: Optional[datetime] = None
```

**åˆå¿ƒè€…å‘ã‘: field(default_factory)ã®èª¬æ˜**

```python
# âŒ å±é™ºãªæ›¸ãæ–¹ï¼ˆå…¨ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§åŒã˜ãƒªã‚¹ãƒˆã‚’å…±æœ‰ï¼‰
@dataclass
class Config:
    tags: List[str] = []  # å…±æœ‰ã•ã‚Œã‚‹ï¼

# âœ… å®‰å…¨ãªæ›¸ãæ–¹ï¼ˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã”ã¨ã«æ–°ã—ã„ãƒªã‚¹ãƒˆã‚’ä½œæˆï¼‰
@dataclass  
class Config:
    tags: List[str] = field(default_factory=list)

# å®Ÿéš›ã®å‹•ä½œ
config1 = Config()
config2 = Config()
config1.tags.append("tag1")
print(config2.tags)  # fieldä½¿ç”¨: [] (å½±éŸ¿ãªã—)
                     # fieldæœªä½¿ç”¨: ["tag1"] (å½±éŸ¿ã‚ã‚Š)
```

#### **ğŸ”§ è¨­å®šãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†æ©Ÿèƒ½**

```python
class PlaylistConfigDatabase:
    """ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¨­å®šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹"""
    
    def __init__(self):
        self.configs: Dict[str, PlaylistConfig] = {}
        self.total_playlists: int = 0
        self.last_updated: Optional[datetime] = None
        self.database_version: str = "1.0.0"
    
    def add_config(self, config: PlaylistConfig) -> bool:
        """è¨­å®šã‚’è¿½åŠ """
        if config.playlist_id in self.configs:
            return False  # é‡è¤‡ãƒã‚§ãƒƒã‚¯
        
        self.configs[config.playlist_id] = config
        self.total_playlists = len(self.configs)
        self.last_updated = datetime.now()
        return True
    
    def get_enabled_configs(self) -> List[PlaylistConfig]:
        """æœ‰åŠ¹ãªè¨­å®šã®ã¿å–å¾—"""
        return [config for config in self.configs.values() if config.enabled]
```

### **è¨­å®šã®æ°¸ç¶šåŒ–ã¨ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³**

#### **ğŸ’¿ JSONå½¢å¼ã§ã®ä¿å­˜ãƒ»èª­ã¿è¾¼ã¿**

```python
def save_configs(self) -> bool:
    """è¨­å®šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä¿å­˜"""
    try:
        config_db = self.load_configs()
        
        # ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ â†’ è¾æ›¸ â†’ JSON å¤‰æ›
        with open(self.config_file, 'w', encoding='utf-8') as f:
            json.dump(config_db.to_dict(), f, ensure_ascii=False, indent=2)
        
        print(f"ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¨­å®šã‚’ä¿å­˜: {self.config_file}")
        return True
        
    except Exception as e:
        print(f"è¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼: {e}")
        return False

def load_configs(self) -> PlaylistConfigDatabase:
    """è¨­å®šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’èª­ã¿è¾¼ã¿"""
    if self.config_file.exists():
        try:
            with open(self.config_file, 'r', encoding='utf-8') as f:
                data = json.load(f)
            # JSON â†’ è¾æ›¸ â†’ ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ å¤‰æ›
            self._config_db = PlaylistConfigDatabase.from_dict(data)
            return self._config_db
        except Exception as e:
            print(f"è¨­å®šèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: {e}")
            # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: æ–°è¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ
            return create_empty_playlist_config_database()
```

**åˆå¿ƒè€…å‘ã‘: to_dict/from_dictã®ä»•çµ„ã¿**

```python
# ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ â†’ è¾æ›¸å¤‰æ›ï¼ˆä¿å­˜ç”¨ï¼‰
config = PlaylistConfig("PLxxx", "ãƒ†ã‚¹ãƒˆ")
config_dict = {
    "playlist_id": config.playlist_id,
    "display_name": config.display_name,
    "update_frequency": config.update_frequency.value,  # Enumâ†’æ–‡å­—åˆ—
    "priority": config.priority,
    "enabled": config.enabled,
    "created_at": config.created_at.isoformat()  # datetimeâ†’ISOæ–‡å­—åˆ—
}

# è¾æ›¸ â†’ ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹å¤‰æ›ï¼ˆèª­ã¿è¾¼ã¿ç”¨ï¼‰
config = PlaylistConfig(
    playlist_id=config_dict["playlist_id"],
    display_name=config_dict["display_name"],
    update_frequency=UpdateFrequency(config_dict["update_frequency"]),  # æ–‡å­—åˆ—â†’Enum
    priority=config_dict["priority"],
    enabled=config_dict["enabled"],
    created_at=datetime.fromisoformat(config_dict["created_at"])  # ISOæ–‡å­—åˆ—â†’datetime
)
```

---

## **ğŸ”„ CRUDæ“ä½œã®å®Ÿè£…**

### **Createï¼ˆä½œæˆï¼‰æ“ä½œ**

#### **â• ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¿½åŠ æ©Ÿèƒ½**

```python
def add_playlist(
    self, 
    url_or_id: str,
    display_name: str = "",
    category: PlaylistCategory = PlaylistCategory.OTHER,
    update_frequency: UpdateFrequency = UpdateFrequency.MANUAL,
    priority: int = 3,
    auto_analyze: bool = True,
    **kwargs
) -> Tuple[bool, str]:
    """ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’è¿½åŠ 
    
    Returns:
        (æˆåŠŸãƒ•ãƒ©ã‚°, ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸)
    """
    try:
        # 1. ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆIDæŠ½å‡ºãƒ»æ¤œè¨¼
        playlist_id = PlaylistConfig.extract_playlist_id(url_or_id)
        if not playlist_id:
            return False, f"ç„¡åŠ¹ãªãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆURL/ID: {url_or_id}"
        
        if not PlaylistConfig.validate_playlist_id(playlist_id):
            return False, f"ç„¡åŠ¹ãªãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆIDå½¢å¼: {playlist_id}"
        
        # 2. é‡è¤‡ãƒã‚§ãƒƒã‚¯
        config_db = self.load_configs()
        if playlist_id in config_db.configs:
            return False, f"ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã¯æ—¢ã«ç™»éŒ²æ¸ˆã¿: {playlist_id}"
        
        # 3. è¡¨ç¤ºåã®è‡ªå‹•ç”Ÿæˆ
        if not display_name:
            display_name = f"ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ_{playlist_id[:8]}"
        
        # 4. URLæ­£è¦åŒ–
        if url_or_id.startswith('PL'):
            url = f"https://www.youtube.com/playlist?list={playlist_id}"
        else:
            url = url_or_id
        
        # 5. è¨­å®šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
        config = PlaylistConfig(
            playlist_id=playlist_id,
            display_name=display_name,
            url=url,
            update_frequency=update_frequency,
            priority=priority,
            enabled=True,
            category=category,
            auto_analyze=auto_analyze,
            description=kwargs.get('description', ''),
            tags=kwargs.get('tags', []),
            max_videos=kwargs.get('max_videos')
        )
        
        # 6. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«è¿½åŠ ãƒ»ä¿å­˜
        config_db.add_config(config)
        self._config_db = config_db
        
        if self.save_configs():
            return True, f"ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’è¿½åŠ ã—ã¾ã—ãŸ: {display_name} ({playlist_id})"
        else:
            return False, "è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ"
            
    except Exception as e:
        return False, f"ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¿½åŠ ã‚¨ãƒ©ãƒ¼: {e}"
```

**åˆå¿ƒè€…å‘ã‘: YouTubeãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆIDã®æŠ½å‡º**

```python
# YouTubeãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆURLã®å½¢å¼
url_examples = [
    "https://www.youtube.com/playlist?list=PLxxxxxxxxxxxxxxxxxxxxxxxxxxx",
    "https://youtube.com/playlist?list=PLxxxxxxxxxxxxxxxxxxxxxxxxxxx&other=param",
    "PLxxxxxxxxxxxxxxxxxxxxxxxxxxx",  # IDç›´æŒ‡å®š
]

def extract_playlist_id(url_or_id: str) -> Optional[str]:
    """ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆIDã‚’æŠ½å‡º"""
    if url_or_id.startswith('PL') and len(url_or_id) >= 32:
        return url_or_id  # ç›´æ¥IDæŒ‡å®š
    
    # URL ã‹ã‚‰list=ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŠ½å‡º
    import re
    match = re.search(r'list=([a-zA-Z0-9_-]+)', url_or_id)
    return match.group(1) if match else None
```

### **Readï¼ˆèª­ã¿å–ã‚Šï¼‰æ“ä½œ**

#### **ğŸ“– è¨­å®šå–å¾—æ©Ÿèƒ½**

```python
def get_config(self, playlist_id: str) -> Optional[PlaylistConfig]:
    """ç‰¹å®šã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¨­å®šã‚’å–å¾—"""
    config_db = self.load_configs()
    return config_db.configs.get(playlist_id)

def list_configs(self, enabled_only: bool = False) -> List[PlaylistConfig]:
    """ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¨­å®šä¸€è¦§ã‚’å–å¾—"""
    config_db = self.load_configs()
    if enabled_only:
        return config_db.get_enabled_configs()
    else:
        return list(config_db.configs.values())

def get_configs_by_priority(self, enabled_only: bool = True) -> List[PlaylistConfig]:
    """å„ªå…ˆåº¦é †ã§ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¨­å®šã‚’å–å¾—"""
    configs = self.list_configs(enabled_only)
    return sorted(configs, key=lambda x: x.priority)  # 1(é«˜) â†’ 5(ä½)

def get_configs_by_category(self, category: PlaylistCategory) -> List[PlaylistConfig]:
    """ã‚«ãƒ†ã‚´ãƒªåˆ¥ã§ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¨­å®šã‚’å–å¾—"""
    config_db = self.load_configs()
    return [config for config in config_db.configs.values() if config.category == category]
```

**åˆå¿ƒè€…å‘ã‘: ã‚½ãƒ¼ãƒˆãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®æ´»ç”¨**

```python
# å„ªå…ˆåº¦ã«ã‚ˆã‚‹ä¸¦ã³æ›¿ãˆ
configs = [
    PlaylistConfig("PL001", "é«˜å„ªå…ˆåº¦", priority=1),
    PlaylistConfig("PL002", "ä¸­å„ªå…ˆåº¦", priority=3),
    PlaylistConfig("PL003", "ä½å„ªå…ˆåº¦", priority=5),
]

# key=lambda ã§ã‚½ãƒ¼ãƒˆæ¡ä»¶æŒ‡å®š
sorted_configs = sorted(configs, key=lambda x: x.priority)
# â†’ [é«˜å„ªå…ˆåº¦(1), ä¸­å„ªå…ˆåº¦(3), ä½å„ªå…ˆåº¦(5)] ã®é †

# ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
music_configs = [c for c in configs if c.category == PlaylistCategory.MUSIC]
enabled_configs = [c for c in configs if c.enabled]
```

### **Updateï¼ˆæ›´æ–°ï¼‰æ“ä½œ**

#### **âœï¸ è¨­å®šæ›´æ–°æ©Ÿèƒ½**

```python
def update_config(self, playlist_id: str, **updates) -> Tuple[bool, str]:
    """ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¨­å®šã‚’æ›´æ–°"""
    try:
        config_db = self.load_configs()
        
        if playlist_id not in config_db.configs:
            return False, f"ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {playlist_id}"
        
        config = config_db.configs[playlist_id]
        
        # æ›´æ–°å¯èƒ½ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’åˆ¶é™ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼‰
        allowed_updates = {
            'display_name', 'update_frequency', 'priority', 'enabled',
            'category', 'auto_analyze', 'description', 'tags', 'max_videos'
        }
        
        updated_fields = []
        for field, value in updates.items():
            if field in allowed_updates:
                # Enumå‹ã®è‡ªå‹•å¤‰æ›
                if field == 'update_frequency' and isinstance(value, str):
                    value = UpdateFrequency(value)
                elif field == 'category' and isinstance(value, str):
                    value = PlaylistCategory(value)
                
                setattr(config, field, value)  # å‹•çš„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ›´æ–°
                updated_fields.append(field)
        
        if updated_fields:
            config.last_updated = datetime.now()
            config_db.last_updated = datetime.now()
            self._config_db = config_db
            
            if self.save_configs():
                return True, f"è¨­å®šã‚’æ›´æ–°ã—ã¾ã—ãŸ: {', '.join(updated_fields)}"
            else:
                return False, "è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ"
        else:
            return False, "æ›´æ–°ã™ã‚‹é …ç›®ãŒã‚ã‚Šã¾ã›ã‚“"
            
    except Exception as e:
        return False, f"è¨­å®šæ›´æ–°ã‚¨ãƒ©ãƒ¼: {e}"
```

**åˆå¿ƒè€…å‘ã‘: setattr()ã«ã‚ˆã‚‹å‹•çš„å±æ€§æ›´æ–°**

```python
# setattr() ã®ä½¿ç”¨ä¾‹
config = PlaylistConfig("PLxxx", "ãƒ†ã‚¹ãƒˆ")

# é€šå¸¸ã®å±æ€§æ›´æ–°
config.display_name = "æ–°ã—ã„åå‰"

# setattr() ã«ã‚ˆã‚‹å‹•çš„æ›´æ–°ï¼ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åãŒå¤‰æ•°ã®å ´åˆï¼‰
field_name = "display_name"
new_value = "æ–°ã—ã„åå‰"
setattr(config, field_name, new_value)  # ä¸Šè¨˜ã¨åŒã˜åŠ¹æœ

# è¾æ›¸ã‹ã‚‰ä¸€æ‹¬æ›´æ–°
updates = {"display_name": "æ›´æ–°å", "priority": 1}
for field, value in updates.items():
    setattr(config, field, value)
```

### **Deleteï¼ˆå‰Šé™¤ï¼‰æ“ä½œ**

#### **ğŸ—‘ï¸ ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆå‰Šé™¤æ©Ÿèƒ½**

```python
def remove_playlist(self, playlist_id: str) -> Tuple[bool, str]:
    """ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’å‰Šé™¤"""
    try:
        config_db = self.load_configs()
        
        if playlist_id not in config_db.configs:
            return False, f"ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {playlist_id}"
        
        config = config_db.configs[playlist_id]
        display_name = config.display_name
        
        # å‰Šé™¤å®Ÿè¡Œ
        if config_db.remove_config(playlist_id):
            self._config_db = config_db
            
            if self.save_configs():
                return True, f"ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’å‰Šé™¤ã—ã¾ã—ãŸ: {display_name} ({playlist_id})"
            else:
                return False, "è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ"
        else:
            return False, f"å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: {playlist_id}"
            
    except Exception as e:
        return False, f"ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆå‰Šé™¤ã‚¨ãƒ©ãƒ¼: {e}"
```

---

## **ğŸ’¾ è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚·ã‚¹ãƒ†ãƒ **

### **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®é‡è¦æ€§**

#### **ğŸ›¡ï¸ ãƒ‡ãƒ¼ã‚¿ä¿è­·ã®å¿…è¦æ€§**

è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã®å‹•ä½œã‚’å·¦å³ã™ã‚‹é‡è¦ãªãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚ä»¥ä¸‹ã®ç†ç”±ã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒå¿…è¦ï¼š

1. **äººçš„ãƒŸã‚¹**: èª¤ã£ãŸè¨­å®šå¤‰æ›´ãƒ»å‰Šé™¤
2. **ã‚·ã‚¹ãƒ†ãƒ éšœå®³**: ãƒ•ã‚¡ã‚¤ãƒ«ç ´æãƒ»ãƒ‡ã‚£ã‚¹ã‚¯éšœå®³
3. **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¸å…·åˆ**: ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒã‚°ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ç ´æ
4. **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**: è¨­å®šå¤‰æ›´ã®å±¥æ­´è¿½è·¡

### **è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®å®Ÿè£…**

#### **ğŸ“ ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ããƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**

```python
def save_configs(self) -> bool:
    """è¨­å®šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä¿å­˜ï¼ˆè‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä»˜ãï¼‰"""
    try:
        # 1. æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
        if self.config_file.exists():
            # ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ããƒ•ã‚¡ã‚¤ãƒ«åç”Ÿæˆ
            backup_name = f"playlist_configs_backup_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json"
            backup_path = self.backup_dir / backup_name
            
            # ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ”ãƒ¼ï¼ˆãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å«ã‚€ï¼‰
            import shutil
            shutil.copy2(self.config_file, backup_path)
            print(f"è¨­å®šãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆ: {backup_path}")
        
        # 2. æ–°ã—ã„è¨­å®šã‚’ä¿å­˜
        config_db = self.load_configs()
        with open(self.config_file, 'w', encoding='utf-8') as f:
            json.dump(config_db.to_dict(), f, ensure_ascii=False, indent=2)
        
        print(f"ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¨­å®šã‚’ä¿å­˜: {self.config_file}")
        return True
        
    except Exception as e:
        print(f"è¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼: {e}")
        return False
```

**åˆå¿ƒè€…å‘ã‘: shutil.copy2()ã®ç‰¹å¾´**

```python
import shutil
from pathlib import Path

# copy2() ã®æ©Ÿèƒ½
source = Path("original_config.json")
backup = Path("backup_config.json")

shutil.copy2(source, backup)
# â†‘ ä»¥ä¸‹ã®æƒ…å ±ã‚’ã™ã¹ã¦ã‚³ãƒ”ãƒ¼:
# - ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹
# - ä½œæˆæ—¥æ™‚
# - æ›´æ–°æ—¥æ™‚
# - ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™

# copy() ã¨ã®é•ã„
shutil.copy(source, backup)   # å†…å®¹ã®ã¿ã‚³ãƒ”ãƒ¼ï¼ˆãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãªã—ï¼‰
shutil.copy2(source, backup)  # å†…å®¹+ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆæ¨å¥¨ï¼‰
```

#### **ğŸ—‚ï¸ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†**

```python
def cleanup_old_backups(self, keep_days: int = 30) -> None:
    """å¤ã„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤"""
    try:
        import time
        cutoff_time = time.time() - (keep_days * 24 * 60 * 60)
        
        # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã‚¹ã‚­ãƒ£ãƒ³
        for backup_file in self.backup_dir.glob("playlist_configs_backup_*.json"):
            file_mtime = backup_file.stat().st_mtime
            
            if file_mtime < cutoff_time:
                backup_file.unlink()  # ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
                print(f"å¤ã„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å‰Šé™¤: {backup_file}")
                
    except Exception as e:
        print(f"ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼: {e}")

def list_backups(self) -> List[Path]:
    """åˆ©ç”¨å¯èƒ½ãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§"""
    backups = list(self.backup_dir.glob("playlist_configs_backup_*.json"))
    return sorted(backups, key=lambda x: x.stat().st_mtime, reverse=True)
```

### **å¾©æ—§æ©Ÿèƒ½ã®å®Ÿè£…**

#### **ğŸ”„ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ã®å¾©æ—§**

```python
def restore_from_backup(self, backup_file: Path) -> Tuple[bool, str]:
    """ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å¾©æ—§"""
    try:
        if not backup_file.exists():
            return False, f"ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {backup_file}"
        
        # ç¾åœ¨ã®è¨­å®šã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆå¾©æ—§å‰ã®çŠ¶æ…‹ä¿æŒï¼‰
        if self.config_file.exists():
            emergency_backup = self.backup_dir / f"emergency_backup_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json"
            shutil.copy2(self.config_file, emergency_backup)
            print(f"ç·Šæ€¥ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆ: {emergency_backup}")
        
        # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å¾©æ—§
        shutil.copy2(backup_file, self.config_file)
        
        # å¾©æ—§ã—ãŸãƒ‡ãƒ¼ã‚¿ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯
        try:
            self._config_db = None  # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
            config_db = self.load_configs()
            print(f"è¨­å®šå¾©æ—§å®Œäº†: {config_db.total_playlists}ä»¶ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ")
            return True, f"ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰æ­£å¸¸ã«å¾©æ—§ã—ã¾ã—ãŸ: {backup_file.name}"
            
        except Exception as load_error:
            # å¾©æ—§å¤±æ•—æ™‚ã¯ç·Šæ€¥ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰æˆ»ã™
            if emergency_backup.exists():
                shutil.copy2(emergency_backup, self.config_file)
            return False, f"å¾©æ—§å¾Œã®ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã«å¤±æ•—: {load_error}"
        
    except Exception as e:
        return False, f"å¾©æ—§å‡¦ç†ã‚¨ãƒ©ãƒ¼: {e}"
```

---

## **ğŸ” è¨­å®šæ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ **

### **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯**

#### **âœ… è¨­å®šå€¤ã®å¦¥å½“æ€§æ¤œè¨¼**

```python
def validate_all_configs(self) -> List[Tuple[str, str]]:
    """å…¨è¨­å®šã®å¦¥å½“æ€§ã‚’ãƒã‚§ãƒƒã‚¯"""
    config_db = self.load_configs()
    issues = []
    
    for playlist_id, config in config_db.configs.items():
        # 1. ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆIDå½¢å¼ãƒã‚§ãƒƒã‚¯
        if not PlaylistConfig.validate_playlist_id(playlist_id):
            issues.append((playlist_id, f"ç„¡åŠ¹ãªãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆIDå½¢å¼: {playlist_id}"))
        
        # 2. å„ªå…ˆåº¦ç¯„å›²ãƒã‚§ãƒƒã‚¯
        if not (1 <= config.priority <= 5):
            issues.append((playlist_id, f"å„ªå…ˆåº¦ãŒç¯„å›²å¤–: {config.priority} (1-5)"))
        
        # 3. è¡¨ç¤ºåãƒã‚§ãƒƒã‚¯
        if not config.display_name or len(config.display_name.strip()) == 0:
            issues.append((playlist_id, "è¡¨ç¤ºåãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“"))
        
        # 4. URLå½¢å¼ãƒã‚§ãƒƒã‚¯
        if not config.url.startswith(('http://', 'https://')):
            issues.append((playlist_id, f"ç„¡åŠ¹ãªURLå½¢å¼: {config.url}"))
        
        # 5. ã‚¿ã‚°ã®é‡è¤‡ãƒã‚§ãƒƒã‚¯
        if len(config.tags) != len(set(config.tags)):
            issues.append((playlist_id, "ã‚¿ã‚°ã«é‡è¤‡ãŒã‚ã‚Šã¾ã™"))
        
        # 6. æœ€å¤§å‹•ç”»æ•°ãƒã‚§ãƒƒã‚¯
        if config.max_videos is not None and config.max_videos <= 0:
            issues.append((playlist_id, f"ç„¡åŠ¹ãªæœ€å¤§å‹•ç”»æ•°: {config.max_videos}"))
    
    return issues
```

**åˆå¿ƒè€…å‘ã‘: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®é‡è¦æ€§**

```python
# ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãªã—ã®å•é¡Œä¾‹
config = PlaylistConfig(
    playlist_id="invalid_id",        # âŒ ç„¡åŠ¹ãªIDå½¢å¼
    display_name="",                 # âŒ ç©ºã®è¡¨ç¤ºå
    priority=10,                     # âŒ ç¯„å›²å¤–ã®å„ªå…ˆåº¦
    max_videos=-5                    # âŒ è² ã®å‹•ç”»æ•°
)
# â†’ ã‚·ã‚¹ãƒ†ãƒ å®Ÿè¡Œæ™‚ã«äºˆæœŸã—ãªã„ä¸å…·åˆãŒç™ºç”Ÿ

# ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãã®å®‰å…¨ãªå®Ÿè£…
def validate_config(config: PlaylistConfig) -> List[str]:
    errors = []
    if not config.playlist_id.startswith('PL'):
        errors.append("ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆIDã¯ 'PL' ã§å§‹ã¾ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™")
    if not config.display_name.strip():
        errors.append("è¡¨ç¤ºåã¯å¿…é ˆã§ã™")
    return errors
```

### **è¨­å®šçµ±è¨ˆã¨åˆ†æ**

#### **ğŸ“Š è¨­å®šãƒ‡ãƒ¼ã‚¿ã®çµ±è¨ˆåˆ†æ**

```python
def get_statistics(self) -> Dict[str, any]:
    """çµ±è¨ˆæƒ…å ±ã‚’å–å¾—"""
    config_db = self.load_configs()
    
    total = len(config_db.configs)
    enabled = len([c for c in config_db.configs.values() if c.enabled])
    
    # ã‚«ãƒ†ã‚´ãƒªåˆ¥é›†è¨ˆ
    category_stats = {}
    for category in PlaylistCategory:
        count = len([c for c in config_db.configs.values() if c.category == category])
        if count > 0:
            category_stats[category.value] = count
    
    # æ›´æ–°é »åº¦åˆ¥é›†è¨ˆ
    frequency_stats = {}
    for freq in UpdateFrequency:
        count = len([c for c in config_db.configs.values() if c.update_frequency == freq])
        if count > 0:
            frequency_stats[freq.value] = count
    
    # å„ªå…ˆåº¦åˆ†å¸ƒ
    priority_stats = {}
    for priority in range(1, 6):
        count = len([c for c in config_db.configs.values() if c.priority == priority])
        if count > 0:
            priority_stats[str(priority)] = count
    
    return {
        'total_playlists': total,
        'enabled_playlists': enabled,
        'disabled_playlists': total - enabled,
        'enable_rate': enabled / total * 100 if total > 0 else 0,
        'category_stats': category_stats,
        'frequency_stats': frequency_stats,
        'priority_stats': priority_stats,
        'last_updated': config_db.last_updated.isoformat() if config_db.last_updated else None
    }
```

---

## **ğŸ”§ ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹ç®¡ç†**

### **ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã¯ï¼ˆåˆå¿ƒè€…å‘ã‘è§£èª¬ï¼‰**

#### **ğŸ¢ ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã®åŸºæœ¬æ¦‚å¿µ**

**ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä»•çµ„ã¿**

ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã€**ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’1ã¤ã ã‘ã«åˆ¶é™ã™ã‚‹è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³**ã§ã™ã€‚ä¼šç¤¾ã®ç¤¾é•·ã«ä¾‹ãˆã‚‹ã¨ï¼š

```python
# å•é¡Œã®ã‚ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆè¤‡æ•°ã®ç®¡ç†è€…ï¼‰
manager1 = PlaylistConfigManager()
manager2 = PlaylistConfigManager()
# â†’ è¨­å®šãŒåŒæœŸã•ã‚Œãªã„ã€ãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆãŒç™ºç”Ÿ

# ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ1ã¤ã®ç®¡ç†è€…ã®ã¿ï¼‰
manager1 = get_config_manager()
manager2 = get_config_manager()
# â†’ manager1 ã¨ manager2 ã¯åŒã˜ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
```

#### **ğŸ¯ è¨­å®šç®¡ç†ã§ã®ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ¡ãƒªãƒƒãƒˆ**

1. **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§**: è¤‡æ•°ç®‡æ‰€ã‹ã‚‰åŒã˜è¨­å®šã«ã‚¢ã‚¯ã‚»ã‚¹
2. **ãƒ¡ãƒ¢ãƒªåŠ¹ç‡**: è¨­å®šãƒ‡ãƒ¼ã‚¿ã‚’é‡è¤‡ã—ã¦èª­ã¿è¾¼ã¾ãªã„
3. **çŠ¶æ…‹å…±æœ‰**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã§è¨­å®šå¤‰æ›´ã‚’å…±æœ‰
4. **ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã®ä¸€å…ƒåŒ–

### **ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã®å®Ÿè£…ä¾‹**

#### **ğŸ”§ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ¬ãƒ™ãƒ«ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³**

```python
# managers/playlist_config_manager.py ã®æœ«å°¾
_config_manager_instance = None

def get_config_manager() -> PlaylistConfigManager:
    """è¨­å®šç®¡ç†ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å–å¾—ï¼ˆã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ï¼‰"""
    global _config_manager_instance
    if _config_manager_instance is None:
        _config_manager_instance = PlaylistConfigManager()
    return _config_manager_instance

def reset_config_manager():
    """è¨­å®šç®¡ç†ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰"""
    global _config_manager_instance
    _config_manager_instance = None
```

**åˆå¿ƒè€…å‘ã‘: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ¬ãƒ™ãƒ«ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã®åˆ©ç‚¹**

```python
# Python ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯è‡ªå‹•çš„ã«ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³
# åŒã˜ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ä¸€åº¦ã ã‘èª­ã¿è¾¼ã¾ã‚Œã‚‹

# file1.py
from managers.playlist_config_manager import get_config_manager
manager = get_config_manager()
manager.add_playlist("PLxxx", "ãƒ†ã‚¹ãƒˆ1")

# file2.py  
from managers.playlist_config_manager import get_config_manager
manager = get_config_manager()  # åŒã˜ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
configs = manager.list_configs()  # "ãƒ†ã‚¹ãƒˆ1"ãŒè¡¨ç¤ºã•ã‚Œã‚‹
```

#### **ğŸ—ï¸ ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ï¼ˆå‚è€ƒå®Ÿè£…ï¼‰**

```python
class SingletonConfigManager:
    """ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è¨­å®šç®¡ç†ã‚¯ãƒ©ã‚¹"""
    _instance = None
    _initialized = False
    
    def __new__(cls):
        if cls._instance is None:
            cls._instance = super().__new__(cls)
        return cls._instance
    
    def __init__(self):
        # åˆæœŸåŒ–ã¯ä¸€åº¦ã ã‘å®Ÿè¡Œ
        if not self._initialized:
            self.config_dir = DATA_DIR
            self.config_file = self.config_dir / "playlist_configs.json"
            self._config_db = None
            self._initialized = True

# ä½¿ç”¨ä¾‹
manager1 = SingletonConfigManager()
manager2 = SingletonConfigManager()
print(manager1 is manager2)  # Trueï¼ˆåŒã˜ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼‰
```

ã“ã®ç« ã§ã¯ã€Enumã«ã‚ˆã‚‹å‹å®‰å…¨ãªè¨­å®šç®¡ç†ã‹ã‚‰è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚·ã‚¹ãƒ†ãƒ ã¾ã§ã€å®Ÿè·µçš„ãªè¨­å®šç®¡ç†æŠ€è¡“ã‚’å­¦ã³ã¾ã—ãŸã€‚ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã«ã‚ˆã‚‹æ§‹é€ åŒ–ã€CRUDã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ãªã©ã€æœ¬æ ¼çš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã§å¿…è¦ã¨ãªã‚‹é‡è¦ãªæ¦‚å¿µã‚’ç¿’å¾—ã§ãã¾ã—ãŸã€‚æ¬¡ç« ã§ã¯ã€GUIã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…ã«ã¤ã„ã¦è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚